---
import BaseLayout from "../BaseLayout.astro";
import Story from "../components/Story.astro";

const response = await fetch(`http://localhost:1337/api/main-page?populate%5BContent%5D%5Bpopulate%5D=%2A`).then(res => res.json());
const data = response.data;

---

<BaseLayout>
	<main>
		{
			data.attributes.Content.map( block =>
				<>
					{
						block.Stories &&
							<section class="mpp-stories">
								<div class="container">
									<h2>{block.title}</h2>
								</div>
								<div class="mpp-stories-wrap container">
									<ul class="mpp-stories-grid">
										{block.Stories?.map( item => <Story {...item} />)}
									</ul>
								</div>
							</section>
					}
				</>
			)
		}
	</main>
</BaseLayout>

<style lang="scss" >

.mpp-headers {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	z-index: 2;
	background-color: #FFFFFF;
}
/* Stories */
.mpp-stories {
        padding: 2em 0;
        & h2 {
            font-size: 1.25rem;
            font-weight: 500;
            margin: 0 0 .5em;
        }
    }

    .mpp-stories-wrap {
        @media (max-width: 768px) {
            overflow-x: auto;
        }
    }

    .mpp-stories-grid {
        gap: 2rem;
        display: flex;
        flex-flow: row;
        min-width: 100%;
        padding: 0.7em 0 0;

        @media (min-width: 768px) {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
        }
    }

    /* Features */
    .mpp-features {
    padding: 2em 0;
    background-color: #F8714C;
    h2 {
        font-size: 1.25rem;
        font-weight: 500;
        color: #fff;
        margin: 0 0 .5em;
    }

}

    .mpp-features-wrap {
        overflow-x: auto;
    }

    .mpp-features-grid {
        display: flex;
        gap: 2em;
        display: flex;
        flex-flow: row;
        min-width: 100%;
        padding: 0.7em 0 0;
    }
</style>