---
const response = await fetch(`http://localhost:1337/api/navigation/render/mobile-menu?type=TREE`);
const data = await response.json();
---
<nav class="mpp-main-mobile-menu">
    <ul>
        {
            data.map((item: { path: string | URL; title: unknown; items: any[]; index: any; }) => 
                <li class="mpp-main-mobile-menu-item-lvl-1">
                    <a href={item.path}>{item.title}</a>
                        {
                            item.items && 
                            <input id={`dropdown-list-${item.index}`} class="mpp-main-mobile-toggle" type="checkbox" checked="checked" value="" />
                            <label for={`dropdown-list-${item.index}`}>
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="7" viewBox="0 0 12 7" fill="none">
                                    <path d="M1 1L6 6L11 1" stroke="black" stroke-opacity="0.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </label>
                            <ul class="mpp-main-mobile-menu-list-lvl-2">
                            {
                                item.items.map( (_item: { path: string | URL; title: unknown; }) =>
                                    <li class="mpp-main-mobile-menu-item-lvl-2 ">
                                        <a href={_item.path}>{ _item.title }</a>
                                    </li>
                                )
                            }
                        </ul>  
                        }
                </li> 
            )
        }
    </ul>
</nav>

<style is:global>
.logo {
    margin: 0 11vw 0 0;
}

.mpp-header-mobile {
    position: relative;
    padding: .6rem 0;
    font-size: .75em;
    font-weight: 600;
    @media (min-width: 768px) {
        display: none;
    }
}

.mpp-contacts {
    display: flex;
    align-items: center;
    gap: 0.75em;
}

.mpp-contacts-icon {
    display: block;
}

.mpp-header-mobile-wrap {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
}

.mpp-main-menu {
    flex-basis: 100%;
}

.mpp-main-menu-wrapper {
    position: relative;
    padding: .5em 0;
    overflow-x: auto;
    & a {
        white-space: nowrap;
    }
}

.mpp-main-menu-list-lvl-1 {
    display: flex;
    gap: 1.5em;
}

.mpp-main-mobile-menu {
    padding: 1.2rem 2rem;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: #fff;
    box-shadow: 0 4px 4px 0 rgba(0, 0, 0, 0.25);

    & ul {
        display: flex;
        flex-direction: column;
        gap: 1em;
    }
}


.mpp-main-mobile-menu-item-lvl-1 {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;

    
}

.mpp-main-mobile-menu-list-lvl-2 {
    flex-basis: 100%;
    transition: cubic-bezier(0.165, 0.84, 0.44, 1);
    overflow: hidden;
    max-height: 0;
}

.mpp-main-mobile-toggle {
    display: none;
}


.mpp-main-mobile-toggle:checked ~ .mpp-main-mobile-menu-list-lvl-2 {
    margin: 1em 0 0 3.5em;
    max-height: 1000px;


}

.mpp-main-mobile-toggle:checked ~ label {
    transform: rotate(180deg);
}

.mpp-main-mobile-toggle:checked ~ label svg path {
    stroke: #F3704E;
}

</style>